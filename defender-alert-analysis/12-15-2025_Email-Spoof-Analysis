## Incident Response

**Platform:** Microsoft Defender XDR / Exchange Admin

**Category:**  
Email Security

**Incident Type:**  
Spoofed Email

**Severity:**  
Medium

**Final Classification:**  
True Positive

**Response Level:**  
Escalated

**Controls Involved:**  
Email configuration SFP/DKIM/DMARC, transport rules, message trace, Entra ID sign in logs, 

---

## Identification
Defender did not flag this incident but it was reported to IT directly from the affected user.

USER1 directly reports that they received a Teams meeting invite from what appears to be their own account that they did not send.


---

## Analysis
First step performed in the investigation was to check sign in logs for USER1 in Entra ID.  No suspicuous login activity was seen in last month of logs.

As a precaution, using Microsoft Admin Center, forced logout of all sessions for USER1 account.

Performed a Message Trace in Exchange Admin center.

From the Received Message Trace, Confirmed that at 3:51pm an account the exact same as USER1's account did email what looked to be a Teams meeting.
From the Sent Message Trace, confirmed an exact copy of USER1 account sent the Teams meeting message, the email was showing as sent by our USER1, however the username was all capitals.(

Double checked account name for any typos or mispellings to initially explain how the Threat Actor contacted USER1.  Account appears to be the exact same, no typos or tricky characters found.

Additional message trace information:
DMARC Failed
SPF Pass

Using Explorer in Defender, and double checked with VirusTotal, verified with all links within the email were custom crafted to contain malicious URLs disgused as normal expected links within Teams (example: Join Meeting, call options, etc)

Visited USER1's desk to confirm they did not click any links.
As a precaution while invetigation was still underway, walked USER1 through a password reset while at their desk.

Concluded that a TA was emailing USER1 from a spoofed account to mimic their actual account. The emails were crafted to look exactly like a Teams meeting invite however all links were malicious.

Escalacted to the Security team to review transport rules that allow pefrectly spoofed emails containing domain @ourcompany.com to be received maliciously.


---

## Containment
Reset USER1 password
Signed out of all Sessions via Microsoft 365 Admin Center

---

## Eradication
Advised USER1 to delete and ignore emails.

---

## Recovery / Remediation
Escalated to the Security Team to adjust transport rules.

---

## Lessons Learned
TA can perfectly spoof account names, it does not always have to contain a sneaky typo or character to purely look similar.